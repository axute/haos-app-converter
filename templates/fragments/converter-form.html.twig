<form id="converterForm" style="display:none;">
    <input type="hidden" id="form_slug" value="">
    <div id="converterContent" class="ha-card">
        <div class="accordion" id="formAccordion">
            
            <!-- Section 1: Basic Information -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBasic">
                        1. Basic Information
                    </button>
                </h2>
                <div id="collapseBasic" class="accordion-collapse collapse show" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="row g-3">
                            <div class="col-12 col-md-6 mb-3">
                                <label for="name" class="form-label">App Name</label>
                                <input type="text" class="form-control" id="name" required placeholder="e.g. My Awesome Tool">
                            </div>
                            <div class="col-12 col-md-6 mb-3">
                                <label for="version" class="form-label">Version</label>
                                <input type="text" class="form-control" id="version" value="1.0.0">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="description" class="form-label">Description (Short)</label>
                            <input type="text" class="form-control" id="description" placeholder="Short summary for the list">
                        </div>

                        <div class="mb-3">
                            <label for="url" class="form-label">Homepage / URL</label>
                            <input type="url" class="form-control" id="url" placeholder="https://github.com/...">
                            <div class="form-text">Homepage of the app. Here you can explain the app and options.</div>
                        </div>

                        <div class="mb-3">
                            <label for="long_description" class="form-label">Long Description (Markdown / README.md)</label>
                            <textarea class="form-control" id="long_description" rows="10" placeholder="Detailed description, installation instructions, etc. Supports Markdown."></textarea>
                        </div>

                        <div class="row g-3">
                            <div class="col-12 col-md-5">
                                <div class="mb-3">
                                    <label for="image" class="form-label">Docker Image Name</label>
                                    <input type="text" class="form-control" id="image" required placeholder="e.g. nginx or alpine" onchange="detectPM(); fetchImageEnvVars(); fetchImagePorts();">
                                    <div class="form-text">The image name (without tag).</div>
                                </div>
                            </div>
                            <div class="col-12 col-md-3">
                                <div class="mb-3">
                                    <label for="image_tag" class="form-label">Tag</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="image_tag" list="imageTagOptions" placeholder="latest" onchange="detectPM(); fetchImageEnvVars(); fetchImagePorts();">
                                        <button class="btn btn-outline-secondary" type="button" id="btnFetchTags" onclick="fetchImageTags()">
                                            <span id="tagLoader" class="spinner-border spinner-border-sm" role="status" style="display:none;"></span>
                                            <span class="mdi mdi-magnify"></span>
                                        </button>
                                    </div>
                                    <datalist id="imageTagOptions"></datalist>
                                    <datalist id="exposedPorts"></datalist>
                                    <div class="form-text">e.g. latest, 3.14</div>
                                </div>
                            </div>
                            <div class="col-12 col-md-4">
                                <div class="mb-3">
                                    <label class="form-label" for="detected_pm">Detected Package Manager</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="detected_pm" readonly placeholder="unknown">
                                        <button class="btn btn-outline-secondary" type="button" id="btnDetectPM" onclick="detectPM(true)">
                                            <span id="pmLoader" class="spinner-border spinner-border-sm" role="status" style="display:none;"></span>
                                            <span class="mdi mdi-refresh"></span>
                                        </button>
                                    </div>
                                    <div class="form-text">Detected via crane. <span id="pmSupportInline" class="ms-2"></span></div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="icon_file" class="form-label">Icon File (PNG)</label>
                                    <input type="file" class="form-control" id="icon_file" accept="image/png">
                                    <div id="icon_preview" class="mt-2" style="display:none;">
                                        <img src="" alt="Preview" style="max-width: 64px; max-height: 64px;">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Version Management</label>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="version_fixation">
                                        <label class="form-check-label" for="version_fixation"><strong>Fix Version</strong></label>
                                    </div>
                                    <div class="form-text">If enabled, the app version is bound to the docker image tag.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Ingress & UI -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIngress">
                        2. Ingress & Web UI
                    </button>
                </h2>
                <div id="collapseIngress" class="accordion-collapse collapse" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="ingress">
                            <label class="form-check-label" for="ingress">
                                <strong>Enable Home Assistant Ingress</strong> <span class="badge bg-success text-white ms-1" title="overrides auth_api">üõ°Ô∏è #1 +2</span>
                            </label>
                        </div>

                        <div id="ingressOptions" style="display:none;" class="p-3 border rounded mb-3 bg-light">
                            <div class="row g-2">
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="ingress_port" class="form-label">Internal Web Port (Ingress)</label>
                                    <input type="number" class="form-control" id="ingress_port" value="80">
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="ingress_entry" class="form-label">Ingress Entry Path</label>
                                    <input type="text" class="form-control" id="ingress_entry" value="/">
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="panel_icon" class="form-label">Panel Icon (MDI)</label>
                                    <input type="text" class="form-control" id="panel_icon" placeholder="mdi:link-variant">
                                </div>
                                <div class="col-12 col-md-6 mb-3">
                                    <label for="panel_title" class="form-label">Panel Title (optional)</label>
                                    <input type="text" class="form-control" id="panel_title" placeholder="Defaults to app name">
                                </div>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="ingress_stream">
                                <label class="form-check-label" for="ingress_stream">
                                    Enable Ingress Stream
                                </label>
                            </div>
                            <div class="form-check mt-2">
                                <input class="form-check-input" type="checkbox" id="panel_admin" checked>
                                <label class="form-check-label" for="panel_admin">
                                    <strong>Admin Panel Only</strong> - Make the menu entry only available to users in the admin group.
                                </label>
                            </div>
                        </div>

                        <div id="webUiPortContainer" class="mb-3">
                            <div class="row g-2">
                                <div class="col-12 col-md-4 mb-3">
                                    <label for="web_ui_port" class="form-label">Web UI Port (without Ingress)</label>
                                    <input type="number" class="form-control" id="web_ui_port" placeholder="e.g. 8080">
                                </div>
                                <div class="col-12 col-md-4 mb-3">
                                    <label for="web_ui_protocol" class="form-label">Protocol</label>
                                    <select class="form-select" id="web_ui_protocol">
                                        <option value="http" selected>http</option>
                                        <option value="https">https</option>
                                    </select>
                                </div>
                                <div class="col-12 col-md-4 mb-3">
                                    <label for="web_ui_path" class="form-label">Web UI Path</label>
                                    <input type="text" class="form-control" id="web_ui_path" value="/">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Backup Support</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="backup" id="backup_disabled" value="disabled" checked>
                                <label class="form-check-label" for="backup_disabled">
                                    <strong>Disabled</strong> - No backup support for this app.
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="backup" id="backup_hot" value="hot">
                                <label class="form-check-label" for="backup_hot">
                                    <strong>Hot Backup</strong> - The app continues to run during the backup. Data must be in a consistent state on disk.
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="backup" id="backup_cold" value="cold">
                                <label class="form-check-label" for="backup_cold">
                                    <strong>Cold Backup</strong> - The app is stopped before the backup and restarted afterwards. Safer for databases.
                                </label>
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label class="form-label mb-0">Port Mappings</label>
                                <button type="button" class="btn btn-sm btn-ha-outline" onclick="addPortMapping()">
                                    <span class="mdi mdi-plus"></span> Add Port
                                </button>
                            </div>
                            <div id="portsContainer"></div>
                            <div class="form-text mt-1 text-info"><span class="mdi mdi-information-outline"></span> <strong>Note:</strong> Protocols like UDP may require specific Home Assistant versions or host networking to work correctly in some environments.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: Environment & Config -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseConfig">
                        3. Environment & Configuration
                    </button>
                </h2>
                <div id="collapseConfig" class="accordion-collapse collapse" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label class="form-label mb-0">Environment Variables</label>
                                <button type="button" class="btn btn-sm btn-ha-outline" onclick="addEnvVar()">
                                    <span class="mdi mdi-plus"></span> Add Variable
                                </button>
                            </div>
                            <div id="envVarsContainer"></div>
                            <datalist id="envVarKeys"></datalist>
                            <div id="envWarning" class="alert alert-warning mt-2" style="display:none;">
                                <span class="mdi mdi-alert"></span> <strong>Note:</strong> Editable environment variables require the user to set them in the Configuration tab of the app in Home Assistant.
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <label class="form-label mb-0">Volume Mappings / Mounts</label>
                                <button type="button" class="btn btn-sm btn-ha-outline" onclick="addMap()">
                                    <span class="mdi mdi-plus"></span> Add Mapping
                                </button>
                            </div>
                            <div id="mapContainer"></div>
                            <div class="form-text mt-2">Format: Choose folder, mode and optional path (e.g. <code>/data</code>).</div>
                        </div>

                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="tmpfs">
                            <label class="form-check-label" for="tmpfs">
                                <strong>Enable tmpfs</strong>
                            </label>
                            <div class="form-text">If this is set to true, the containers /tmp uses tmpfs, a memory file system.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 4: Advanced & Quirks -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAdvanced">
                        4. Advanced & Quirks Mode
                    </button>
                </h2>
                <div id="collapseAdvanced" class="accordion-collapse collapse" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="quirks_mode" onchange="toggleEditableCheckboxes()">
                            <label class="form-check-label" for="quirks_mode">
                                <strong>Enable Quirks Mode / Custom Entrypoint</strong>
                            </label>
                            <div class="form-text">Allows custom startup scripts and manual overrides. Use only if the default image doesn't work out of the box.</div>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="allow_user_env">
                            <label class="form-check-label" for="allow_user_env">
                                <strong>Allow user to create environment variables</strong>
                            </label>
                            <div class="form-text">If enabled, the Home Assistant user can add their own environment variables in the app configuration.</div>
                        </div>

                        <div id="startupScriptSection" style="display:none;" class="mb-3">
                            <div class="mb-3">
                                <label for="bashio_version" class="form-label d-flex align-items-center">
                                    Bashio Version
                                    <span id="bashioLoader" class="spinner-border spinner-border-sm ms-2" role="status" style="display:none;">
                                        <span class="visually-hidden">Loading...</span>
                                    </span>
                                </label>
                                <select class="form-select" id="bashio_version">
                                    <option value="" selected disabled>Loading versions...</option>
                                </select>
                                <div class="form-text">Will be passed as <code>HAOS_CONVERTER_BASHIO_VERSION</code>.</div>
                            </div>
                            <label for="startup_script" class="form-label">Custom Startup Script (run.sh)</label>
                            <textarea id="startup_script"></textarea>
                            <div class="form-text mt-2">This script will be executed before the main application starts.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 5: Health -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHealth">
                        5. Health
                    </button>
                </h2>
                <div id="collapseHealth" class="accordion-collapse collapse" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label for="timeout" class="form-label">Timeout (seconds)</label>
                                <input type="number" min="0" class="form-control" id="timeout" placeholder="10">
                                <div class="form-text">Default is 10 seconds. Leave empty to use the default.</div>
                            </div>
                        </div>
                        <hr/>
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label for="watchdog_protocol" class="form-label">Watchdog Protocol</label>
                                <select class="form-select" id="watchdog_protocol">
                                    <option value="" selected>‚Äì Off ‚Äì</option>
                                    <option value="http">http</option>
                                    <option value="https">https</option>
                                    <option value="tcp">tcp</option>
                                </select>
                                <div class="form-text">Supports http/https (with path) or tcp (port only).</div>
                            </div>
                            <div class="col-md-3" id="watchdogPortField" style="display:none;">
                                <label for="watchdog_port" class="form-label">Port</label>
                                <input type="number" min="1" max="65535" class="form-control" id="watchdog_port" placeholder="80">
                            </div>
                            <div class="col-md-6" id="watchdogHttpFields" style="display:none;">
                                <label for="watchdog_path" class="form-label">Path (http/https only)</label>
                                <input type="text" class="form-control" id="watchdog_path" placeholder="/">
                                <div class="form-text">Example: <code>/health</code> or <code>/status</code>. Will be appended to the URL.</div>
                            </div>
                        </div>
                        <div class="form-text mt-2"><span class="mdi mdi-information-outline"></span> Note: The watchdog format in Home Assistant is e.g. <code>http://[HOST]:[PORT:8080]/health</code> or <code>tcp://[HOST]:[PORT:80]</code>.</div>
                    </div>
                </div>
            </div>

            <!-- Section 6: Feature Flags -->
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFeatures">
                        6. Feature Flags
                    </button>
                </h2>
                <div id="collapseFeatures" class="accordion-collapse collapse" data-bs-parent="#formAccordion">
                    <div class="accordion-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="host_network">
                                    <label class="form-check-label" for="host_network"><strong>host_network</strong> <span class="badge bg-danger text-white ms-1" title="Lowers security rating">üõ°Ô∏è #8 -1</span></label>
                                    <div class="form-text">If true, the app runs on the host network.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="host_ipc">
                                    <label class="form-check-label" for="host_ipc"><strong>host_ipc</strong></label>
                                    <div class="form-text">Allow the IPC namespace to be shared with others.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="host_dbus">
                                    <label class="form-check-label" for="host_dbus"><strong>host_dbus</strong></label>
                                    <div class="form-text">Map the host D-Bus service into the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="host_pid">
                                    <label class="form-check-label" for="host_pid"><strong>host_pid</strong> <span class="badge bg-danger text-white ms-1" title="Lowers security rating">üõ°Ô∏è #10 -2</span></label>
                                    <div class="form-text">Allow the container to run on the host PID namespace.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="host_uts">
                                    <label class="form-check-label" for="host_uts"><strong>host_uts</strong> <span class="badge bg-warning text-white ms-1" title="Lowers security rating">üõ°Ô∏è #11 -1 (2/2)</span></label>
                                    <div class="form-text">Use the hosts UTS namespace.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="hassio_api">
                                    <label class="form-check-label" for="hassio_api"><strong>hassio_api</strong></label>
                                    <div class="form-text">This app can access the Supervisor's REST API.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="homeassistant_api">
                                    <label class="form-check-label" for="homeassistant_api"><strong>homeassistant_api</strong></label>
                                    <div class="form-text">This app can access the Home Assistant REST API proxy.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="docker_api">
                                    <label class="form-check-label" for="docker_api"><strong>docker_api</strong> <span class="badge bg-danger text-white ms-1" title="Overrides all other adjustments">üõ°Ô∏è #13 =1</span></label>
                                    <div class="form-text">Allow read-only access to the Docker API for the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="full_access">
                                    <label class="form-check-label" for="full_access"><strong>full_access</strong> <span class="badge bg-danger text-white ms-1" title="Overrides all other adjustments">üõ°Ô∏è #12 =1</span></label>
                                    <div class="form-text">Give full access to hardware like the privileged mode in Docker.</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="audio">
                                    <label class="form-check-label" for="audio"><strong>audio</strong></label>
                                    <div class="form-text">Mark this app to use the internal audio system.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="video">
                                    <label class="form-check-label" for="video"><strong>video</strong></label>
                                    <div class="form-text">Mark this app to use the internal video system.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="gpio">
                                    <label class="form-check-label" for="gpio"><strong>gpio</strong></label>
                                    <div class="form-text">Access to the GPIO interface from the kernel.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="usb">
                                    <label class="form-check-label" for="usb"><strong>usb</strong></label>
                                    <div class="form-text">Map the raw USB access into the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="uart">
                                    <label class="form-check-label" for="uart"><strong>uart</strong></label>
                                    <div class="form-text">Auto mapping all UART/serial devices from the host.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="udev">
                                    <label class="form-check-label" for="udev"><strong>udev</strong></label>
                                    <div class="form-text">Host udev database read-only mounted into the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="devicetree">
                                    <label class="form-check-label" for="devicetree"><strong>devicetree</strong></label>
                                    <div class="form-text">Map /device-tree into the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="kernel_modules">
                                    <label class="form-check-label" for="kernel_modules"><strong>kernel_modules</strong> <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                    <div class="form-text">Map host kernel modules and config into the app.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="stdin">
                                    <label class="form-check-label" for="stdin"><strong>stdin</strong></label>
                                    <div class="form-text">Use the STDIN with Home Assistant API.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="legacy">
                                    <label class="form-check-label" for="legacy"><strong>legacy</strong></label>
                                    <div class="form-text">Enable legacy mode if no labels are present.</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 mb-3">
                                <label class="form-label"><strong>privileged</strong> (Capabilites)</label>
                                <div class="row" id="privileged_list">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="BPF" id="priv_BPF">
                                            <label class="form-check-label" for="priv_BPF">BPF</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="CHECKPOINT_RESTORE" id="priv_CHECKPOINT_RESTORE">
                                            <label class="form-check-label" for="priv_CHECKPOINT_RESTORE">CHECKPOINT_RESTORE</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="DAC_READ_SEARCH" id="priv_DAC_READ_SEARCH">
                                            <label class="form-check-label" for="priv_DAC_READ_SEARCH">DAC_READ_SEARCH <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="IPC_LOCK" id="priv_IPC_LOCK">
                                            <label class="form-check-label" for="priv_IPC_LOCK">IPC_LOCK</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="NET_ADMIN" id="priv_NET_ADMIN">
                                            <label class="form-check-label" for="priv_NET_ADMIN">NET_ADMIN <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="NET_RAW" id="priv_NET_RAW">
                                            <label class="form-check-label" for="priv_NET_RAW">NET_RAW</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="PERFMON" id="priv_PERFMON">
                                            <label class="form-check-label" for="priv_PERFMON">PERFMON</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_ADMIN" id="priv_SYS_ADMIN">
                                            <label class="form-check-label" for="priv_SYS_ADMIN">SYS_ADMIN <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span> <span class="badge bg-warning text-white ms-1" title="In cobination with host-uts will lower the ranking">üõ°Ô∏è #11 -1 (1/2)</span></label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_MODULE" id="priv_SYS_MODULE">
                                            <label class="form-check-label" for="priv_SYS_MODULE">SYS_MODULE <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_NICE" id="priv_SYS_NICE">
                                            <label class="form-check-label" for="priv_SYS_NICE">SYS_NICE</label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_PTRACE" id="priv_SYS_PTRACE">
                                            <label class="form-check-label" for="priv_SYS_PTRACE">SYS_PTRACE <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_RAWIO" id="priv_SYS_RAWIO">
                                            <label class="form-check-label" for="priv_SYS_RAWIO">SYS_RAWIO <span class="badge bg-warning text-white ms-1" title="Rating applied only once if multiple are used.">üõ°Ô∏è #6 -1</span></label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_RESOURCE" id="priv_SYS_RESOURCE">
                                            <label class="form-check-label" for="priv_SYS_RESOURCE">SYS_RESOURCE</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input privileged-checkbox" type="checkbox" value="SYS_TIME" id="priv_SYS_TIME">
                                            <label class="form-check-label" for="priv_SYS_TIME">SYS_TIME</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-text">Privilege for access to hardware/system (Capabilities).</div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="auth_api">
                                    <label class="form-check-label" for="auth_api"><strong>auth_api</strong> <span class="badge bg-success text-white ms-1" title="Increase rating if ingress is off">üõ°Ô∏è #1 +1</span></label>
                                    <div class="form-text">Allow access to Home Assistant user backend.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="advanced">
                                    <label class="form-check-label" for="advanced"><strong>advanced</strong></label>
                                    <div class="form-text">Require "Advanced" mode to show.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="realtime">
                                    <label class="form-check-label" for="realtime"><strong>realtime</strong></label>
                                    <div class="form-text">Access to host schedule including SYS_NICE.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="journald">
                                    <label class="form-check-label" for="journald"><strong>journald</strong></label>
                                    <div class="form-text">Host's system journal mapped read-only.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="apparmor">
                                    <label class="form-check-label" for="apparmor"><strong>apparmor</strong></label>
                                    <div class="form-text">Enable AppArmor protection.</div>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="discovery">
                                    <label class="form-check-label" for="discovery"><strong>discovery</strong></label>
                                    <div class="form-text">Allow the app to use the discovery service.</div>
                                </div>
                                <div class="mb-3 border rounded p-3 bg-light">
                                    <div class="form-check form-switch mb-2">
                                        <input class="form-check-input" type="checkbox" id="apparmor_custom">
                                        <label class="form-check-label" for="apparmor_custom"><strong>Custom AppArmor Profile</strong> <span class="badge bg-success text-white ms-1" title="Custom profile increase the rating">üõ°Ô∏è #4 +1</span> <span class="badge bg-warning text-dark">Experimental</span></label>
                                        <div class="form-text">Generate a custom AppArmor profile based on features and quirks.</div>
                                    </div>
                                    <div id="apparmor_name_container" style="display: none;">
                                        <label for="apparmor_name" class="form-label">Profile Name</label>
                                        <input type="text" class="form-control" id="apparmor_name" placeholder="Leave empty for default (slug)">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="ha-card-footer mt-4">
            <!-- Submit Section for New Apps -->
            <div id="submitSection" class="row g-2" style="display:none;">
                <div class="col-12 col-md-6">
                    <button type="submit" id="generateBtn" class="btn btn-ha-primary btn-lg w-100">
                        <span class="mdi mdi-plus-circle me-2"></span>Create App
                    </button>
                </div>
                <div class="col-12 col-md-6">
                    <button type="button" class="btn btn-ha-outline btn-lg w-100" onclick="cancelConverter()">
                        <span class="mdi mdi-close me-2"></span>Cancel
                    </button>
                </div>
            </div>

            <!-- Update Section for Existing Apps -->
            <div id="updateSection" style="display:none;">
                <div class="row g-2">
                    <div class="col-12 col-md-8 mode-edit-only">
                        <button type="submit" id="updateBtn" class="btn btn-ha-primary btn-lg w-100 h-100">
                            <span class="mdi mdi-content-save me-2"></span>Save Changes
                        </button>
                    </div>
                    <div id="versionUpdateButtons" class="col-12 col-md-4">
                        <div class="btn-group w-100 h-100">
                            <button type="button" class="btn btn-ha-outline btn-lg" onclick="updateVersion('major')">Major</button>
                            <button type="button" class="btn btn-ha-outline btn-lg" onclick="updateVersion('minor')">Minor</button>
                            <button type="button" class="btn btn-ha-primary btn-lg" onclick="updateVersion('fix')">Fix</button>
                        </div>
                    </div>
                    <div class="col-12">
                        <button type="button" class="btn btn-ha-outline btn-lg w-100 mt-2" onclick="cancelConverter()">
                            <span class="mdi mdi-close me-2"></span>Cancel
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="result" class="mt-4" style="display:none;">
                <div class="alert alert-success">
                    <h5 class="alert-heading"><span class="mdi mdi-check-circle me-2"></span>Success!</h5>
                    <p id="resultMessage" class="mb-0"></p>
                </div>
                <div id="resultDetails" class="mt-3"></div>
            </div>
            <div id="error" class="mt-4" style="display:none;">
                <div class="alert alert-danger">
                    <h5 class="alert-heading"><span class="mdi mdi-alert-circle me-2"></span>Error</h5>
                    <p id="errorMessage" class="mb-0"></p>
                </div>
            </div>
        </div>
    </div>
</form>
